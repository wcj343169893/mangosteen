{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\Game.js"],"names":["cc","Class","extends","Component","properties","majiangPrefab","default","type","Prefab","takeoutIndex","takeoutScale","majiangWidth","majiangHeight","basicTakeout","numbers","btnReady","Button","onLoad","console","log","basicHeight","node","height","basicWidth","width","on","begin","start","update","dt","initAllMajiang","mjSize","majiangPool","size","i","majiang","get","addChild","getRandomNumbers","NodePool","initCount","nubArr_wan","nubArr_tiao","nubArr_tong","ent","huase","push","length","sort","a","b","number","posIndex","mjzz","mj","spawnNewMj","setPosition","getNewMjPosition","put","arr","huaIndex","parseInt","nub","Math","random","newMj","instantiate","config","getComponent","game","index","randX","randY","v2","getTakeOutPosition","scaleWidth","outNumb","outLevel","mjX","mjY"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n    \tmajiangPrefab:{\r\n    \t\tdefault:null,\r\n    \t\ttype:cc.Prefab\r\n    \t},\r\n    \t//打出去多少张\r\n    \ttakeoutIndex:0,\r\n    \ttakeoutScale:0.5,\r\n    \tmajiangWidth:58,\r\n    \tmajiangHeight:84,\r\n    \tbasicTakeout:0,\r\n    \tnumbers:[],\r\n    \t//准备按钮\r\n    \tbtnReady:cc.Button,\r\n    \t\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n     onLoad () {\r\n     \tconsole.log(\"开始游戏，创建对象池\");\r\n     \t//console.log(this.node)\r\n     \tthis.basicHeight=-this.node.height/2;\n     \tthis.basicWidth=-this.node.width/2;\r\n     \tthis.basicTakeout = this.basicHeight+220;\r\n     \t//准备按钮绑定事件\r\n     \tthis.btnReady.node.on('click', this.begin, this);\r\n     },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n     update (dt) {\r\n     \t//console.log(\"更新画布\",dt)\r\n     },\r\n     begin:function(){\r\n     \t//洗牌\r\n     \tthis.initAllMajiang();\r\n     \t//显示到屏幕上\r\n     \tlet mjSize = this.majiangPool.size();\r\n     \tconsole.log(\"麻将个数：\"+mjSize);\r\n     \tfor(var i=0;i<mjSize;i++){\r\n\t     \tlet majiang = this.majiangPool.get();\r\n\t     \tthis.node.addChild(majiang);\r\n     \t}\r\n     },\r\n     initAllMajiang:function(){\r\n     \tthis.getRandomNumbers();\r\n     \tthis.majiangPool = new cc.NodePool();\r\n     \tlet initCount = 13;\r\n     \tlet nubArr_wan=[];\r\n     \tlet nubArr_tiao=[];\r\n     \tlet nubArr_tong=[];\r\n     \tfor (let i = 0; i < initCount; ++i) {\r\n     \t\tlet ent=this.numbers[i];\r\n     \t\tif(ent.huase==\"wan\"){\r\n     \t\t\tnubArr_wan.push(ent);\n     \t\t}else if(ent.huase==\"tiao\"){\n\t     \t\tnubArr_tiao.push(ent);\r\n     \t\t}else{\r\n\t     \t\tnubArr_tong.push(ent);\r\n     \t\t}\r\n     \t}\r\n     \tif(nubArr_wan.length>0){\r\n\t     \t//按index排序\r\n\t     \tnubArr_wan.sort(function(a,b){ \r\n\t     \t\treturn a.number>b.number; \r\n\t     \t});\r\n     \t}\n     \tif(nubArr_tiao.length>0){\r\n\t     \t//按index排序\r\n\t     \tnubArr_tiao.sort(function(a,b){ \r\n\t     \t\treturn a.number>b.number; \r\n\t     \t});\r\n     \t}\n     \tif(nubArr_tong.length>0){\r\n\t     \t//按index排序\r\n\t     \tnubArr_tong.sort(function(a,b){ \r\n\t     \t\treturn a.number>b.number; \r\n\t     \t});\r\n     \t}\r\n     \tvar posIndex=0;\r\n     \tfor (let i = 0; i < nubArr_wan.length; ++i) {\r\n\t\t\tlet mjzz=nubArr_wan[i];      \r\n\t        //生成一个新麻将\r\n\t        let mj = this.spawnNewMj(mjzz);\r\n\t        //一排，依次排开\r\n\t\t\tmj.setPosition(this.getNewMjPosition(posIndex));\r\n\t        this.majiangPool.put(mj); // 通过 putInPool 接口放入对象池\r\n\t        posIndex++;\r\n\t    }\n     \tfor (let i = 0; i < nubArr_tiao.length; ++i) {\r\n\t\t\tlet mjzz=nubArr_tiao[i];      \r\n\t        //生成一个新麻将\r\n\t        let mj = this.spawnNewMj(mjzz);\r\n\t        //一排，依次排开\r\n\t\t\tmj.setPosition(this.getNewMjPosition(posIndex));\r\n\t        this.majiangPool.put(mj); // 通过 putInPool 接口放入对象池\r\n\t        posIndex++;\r\n\t    }\n     \tfor (let i = 0; i < nubArr_tong.length; ++i) {\r\n\t\t\tlet mjzz=nubArr_tong[i];      \r\n\t        //生成一个新麻将\r\n\t        let mj = this.spawnNewMj(mjzz);\r\n\t        //一排，依次排开\r\n\t\t\tmj.setPosition(this.getNewMjPosition(posIndex));\r\n\t        this.majiangPool.put(mj); // 通过 putInPool 接口放入对象池\r\n\t        posIndex++;\r\n\t    }\r\n     \t\n     },\r\n     getRandomNumbers:function(){\r\n     \t//产生1-9数字 numbers  ,每个花色36个数字\r\n\t    var arr=[];\r\n\t    var huase=[\"tiao\",\"tong\",\"wan\"];\r\n\t    for(var i=0;i<108;i++){\r\n\t    \tlet huaIndex=parseInt(i/36);\r\n\t    \tlet nub=i%9+1;\r\n\t        arr[i]={\r\n\t        \t\"index\":i,\r\n\t        \t\"key\":huase[huaIndex]+\"_\"+i,\r\n\t        \t\"huase\":huase[huaIndex],\r\n\t        \t\"number\":nub\r\n\t        };\r\n\t    }\r\n\t    //第一次打乱\r\n\t    arr.sort(function(){ return 0.5 - Math.random() });\r\n\t    //第二次打乱\n\t    arr.sort(function(){ return 0.5 - Math.random() });\r\n\t    console.log(arr);\r\n\t    this.numbers=arr;\r\n\t},\r\n     spawnNewMj:function(mjzz){\r\n     \tconsole.log(\"创建麻将：\",mjzz.huase,mjzz.number)\r\n     \t//生成一个新麻将\r\n\t\tvar newMj= cc.instantiate(this.majiangPrefab);\r\n\t\t\r\n\t\t//console.log(\"已经new了\")\r\n\t\t// 将新增的节点添加到 Canvas 节点下面\r\n\t\t//this.node.addChild(newMj);\r\n\t\tvar config = newMj.getComponent('MajiangEntity');\r\n\t\tconfig.game = this;\r\n\t\tconfig.type=mjzz.huase;\r\n\t\tconfig.number=mjzz.number;\r\n\t\t\r\n\t\t//旋转成正面\r\n\t\t//newMj.setRotation(180)\r\n\t\treturn newMj;\r\n     },\r\n     getNewMjPosition:function(index){\r\n\t    //获取新麻将的位置\r\n     \tvar randX=this.basicWidth+(index+1)*(this.majiangWidth-4)+120;\r\n     \tvar randY=this.basicHeight+160;//-this.node./2;\r\n     \t\r\n     \treturn cc.v2(randX,randY);\r\n     },\r\n     getTakeOutPosition:function(){\r\n     \tlet scaleWidth=(this.majiangWidth-4)*this.takeoutScale;\r\n     \tlet outNumb=2;\r\n     \t//获取打出去的位置\r\n     \tlet outLevel = parseInt(this.takeoutIndex/outNumb);\r\n     \t//scaleWidth*10/2+\r\n     \tlet mjX=this.basicWidth+300+(scaleWidth*(this.takeoutIndex-outLevel*outNumb));\r\n     \tlet mjY=this.basicTakeout+outLevel*(this.majiangHeight*this.takeoutScale);\r\n     \tthis.takeoutIndex++;\r\n     \tconsole.log(\"位置：\",outLevel,mjX,mjY);\r\n     \treturn cc.v2(mjX,mjY);\r\n     }\r\n});\r\n"]}