{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\MajiangEntity.js"],"names":["cc","Class","extends","Component","properties","type","number","selectDuration","status","isSelected","clickTimer","onLoad","getBackground","getNumber","node","on","Node","EventType","TOUCH_START","event","TOUCH_END","endTimer","Date","valueOf","onDoubleClick","onClick","setStatus","state","self","loader","loadRes","SpriteFrame","err","spriteFrame","bgNode","sprite","addComponent","Sprite","setPosition","v2","setRotation","addChild","name","console","log","numbNode","enabled","unSelect","game","unSelectOthers","currentMajiang","setScale","takeoutScale","getTakeOutPosition","off","index","updateShoulipai","testGetOne","start"],"mappings":"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","file":"MajiangEntity.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["/**\r\n * 麻将实体\r\n */\r\ncc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t\t//万条筒\r\n\t\ttype: \"\",\r\n\t\t//1-9点数\r\n\t\tnumber: 0,\r\n\t\t//被选中持续时间\r\n\t\tselectDuration: 1,\r\n\t\t//麻将状态，0摸到手，1选中，2对对碰，3明杠，4暗杠，5打出去\r\n\t\tstatus: 0,\r\n\t\tisSelected: false,\r\n\t\t//上一次结束时间，毫秒级\r\n\t\tclickTimer: 0\r\n\t},\r\n\r\n\t// LIFE-CYCLE CALLBACKS:\r\n\tonLoad() {\r\n\t\t//添加背景节点\r\n\t\tthis.getBackground();\r\n\t\t//合成实体\r\n\t\tthis.getNumber();\r\n\t\t//设置状态\r\n\t\t//this.setStatus(0);\r\n\t\t// 触摸开始\r\n\t\tthis.node.on(cc.Node.EventType.TOUCH_START, function(event) {\r\n\t\t\t//console.log('Mouse down');\r\n\t\t}, this);\r\n\t\t//触摸结束\r\n\t\tthis.node.on(cc.Node.EventType.TOUCH_END, function(event) {\r\n\t\t\t//console.log('Mouse end');\r\n\t\t\tvar endTimer = (new Date()).valueOf();\r\n\t\t\t//300毫秒以内2次点击，算doubleclick\r\n\t\t\tif(endTimer - this.clickTimer < 300) {\r\n\t\t\t\tthis.onDoubleClick();\r\n\t\t\t} else {\r\n\t\t\t\tthis.onClick();\r\n\t\t\t}\r\n\t\t\tthis.clickTimer=endTimer;\r\n\t\t}, this);\r\n\t},\r\n\t//设置状态\r\n\tsetStatus: function(state) {\r\n\t\tvar self = this;\r\n\t\t//设置背景状态\r\n\t\tif(self.status == 0 || self.status == 1) {\r\n\r\n\t\t}\r\n\t},\r\n\t//添加背景\r\n\tgetBackground: function() {\r\n\t\tvar self = this;\r\n\t\t//console.log(\"开始数字背景\")\r\n\t\t//加载背景图片\r\n\t\tcc.loader.loadRes('mj_bg', cc.SpriteFrame, function(err, spriteFrame) {\r\n\t\t\tself.bgNode = new cc.Node('mjBackground');\r\n\t\t\tconst sprite = self.bgNode.addComponent(cc.Sprite)\r\n\t\t\t//给sprite的spriteFrame属性 赋值  \r\n\t\t\tsprite.spriteFrame = spriteFrame\r\n\t\t\t//把新的节点追加到self.node节点去。self.node，就是脚本挂载的节点  \r\n\t\t\tself.bgNode.setPosition(cc.v2(0, 0));\r\n\t\t\tself.bgNode.setRotation(180);\r\n\t\t\tself.node.addChild(self.bgNode)\r\n\t\t});\r\n\t},\r\n\r\n\t//添加数字\r\n\tgetNumber: function() {\r\n\t\t//这里加载assets/resource/123.png文件   \r\n\t\tlet name = this.type + \"_\" + this.number;\r\n\t\tconsole.log(\"开始数字\", name)\r\n\t\tvar self = this;\r\n\t\t//console.log(this.getPosition())\r\n\t\t//var entityConfig=this.node.getComponent(\"MajiangEntity\");\r\n\t\tcc.loader.loadRes(name, cc.SpriteFrame, function(err, spriteFrame) {\r\n\t\t\t//创建一个新的节点，因为cc.Sprite是组件不能直接挂载到节点上，只能添加到为节点的一个组件  \r\n\t\t\tself.numbNode = new cc.Node('numberEntity')\r\n\t\t\t//调用新建的node的addComponent函数，会返回一个sprite的对象  \r\n\t\t\tconst sprite = self.numbNode.addComponent(cc.Sprite)\r\n\t\t\t//给sprite的spriteFrame属性 赋值  \r\n\t\t\tsprite.spriteFrame = spriteFrame\r\n\t\t\t//把新的节点追加到self.node节点去。self.node，就是脚本挂载的节点  \r\n\t\t\t//self.numbNode.setPosition(cc.v2(0,12));\r\n\t\t\tself.numbNode.setPosition(cc.v2(0, -12));\r\n\t\t\t//node.setRotation(180);\r\n\t\t\tself.node.addChild(self.numbNode)\r\n\t\t})\r\n\t},\r\n\t//被选中和释放选中\r\n\tonClick: function() {\r\n\t\tif(!this.enabled){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(this.isSelected) {\r\n\t\t\tthis.unSelect();\r\n\t\t} else {\r\n\t\t\tthis.isSelected = true;\r\n\t\t\tthis.bgNode.setRotation(180);\r\n\t\t\tthis.bgNode.setPosition(cc.v2(0, 22));\r\n\t\t\tthis.numbNode.setPosition(cc.v2(0, 12));\r\n\t\t\t//取消其他的选中状态\r\n\t\t\tthis.game.unSelectOthers(this);\r\n\t\t}\r\n\t},\r\n\tonDoubleClick: function() {\r\n\t\t//打出去,如果没有摸牌，是打不出去的\r\n\t\tif(!this.game.currentMajiang){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis.bgNode.setRotation(0);\r\n\t\tthis.bgNode.setPosition(cc.v2(0, 22));\r\n\t\tthis.numbNode.setPosition(cc.v2(0,32));\r\n\t\t//整体变小\r\n\t\tthis.node.setScale(this.game.takeoutScale);\r\n\t\tconsole.log(\"缩放比例\",this.game.takeoutScale)\r\n\t\t//按照顺序，排列在面前，10张\r\n\t\tthis.node.setPosition(this.game.getTakeOutPosition(this.node));\r\n\t\tthis.enabled = false\r\n\t\tthis.node.off(cc.Node.EventType.TOUCH_START);\r\n\t\tthis.node.off(cc.Node.EventType.TOUCH_END);\r\n\t\t//停止并且移除所有正在运行的动作列表。\r\n        //this.node.stopAllActions();\r\n        //如果自己就是新牌,不会影响原来的顺序\r\n        if(this.index != this.game.currentMajiang.index){\r\n        \tthis.game.updateShoulipai(this);\r\n        }else{\r\n        \tthis.game.testGetOne()\r\n        }\r\n\t},\r\n\tstart() {\r\n\r\n\t},\r\n\tunSelect:function(){\r\n\t\tthis.isSelected = false;\r\n\t\tthis.bgNode.setRotation(180);\r\n\t\tthis.bgNode.setPosition(cc.v2(0, 0));\r\n\t\tthis.numbNode.setPosition(cc.v2(0, -12));\r\n\t}\r\n\r\n\r\n\t// update (dt) {},\r\n});"]}