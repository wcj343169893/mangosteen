{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\CurrentMj.js"],"names":["cc","Class","extends","Component","properties","MjSprite","default","type","Prefab","outPrefab","majiangWidth","majiangHeight","majiangJianxi","initScale","realMjWidth","onLoad","realMjHeight","start","initAllCurrentMj","mjs","width","node","aLength","length","fixedPosition","getFixedPosition","forEach","value","index","majiang","spawnNewMj","pos","sub","v2","setPosition","addChild","bind","scheduleUpdate","scheduleOnce","console","log","updateSort","getOne","mjzz","game","hasNewMajiang","CurrentMj","isNewOne","huase","number","mj","instantiate","config","getComponent","setScale","shouliList","push","spawnNewOutMj","dage","dustbin","addNewMj","unSelectOthers","ent","isSelected","unSelect","newList","sort","a","b","newNode","newPos","isLast","rightLength","parentNode","parent","beginPos","add","action","moveTo","easing","easeIn","runAction","newPosFirst","pos2","moveTime","flyAction","easeInOut","flyRota","rotateTo","moveAction","sequence","spawn","scaleTo","delayTime","speed","removeFromList","destroy","takeOut","posX","x","outMj","moveMjFromNew","unHighlightMj","highlightMj"],"mappings":"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","file":"CurrentMj.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["/**\r\n * 我的手里牌列表\r\n */\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n    \t//单个麻将精灵\r\n\t\tMjSprite: {\r\n\t\t\tdefault: null,\r\n\t\t\ttype: cc.Prefab\r\n\t\t},\r\n\t\t //打出去的牌\r\n\t\toutPrefab:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Prefab\r\n\t\t},\r\n\t\t//单个麻将宽度\r\n\t\tmajiangWidth: 58,\r\n\t\t//单个麻将高度\r\n\t\tmajiangHeight: 84,\r\n\t\t//麻将间隙，适用于所有横的排列\r\n\t\tmajiangJianxi: 4,\r\n\t\t//是否有新牌\r\n\t\t//hasNewMajiang: false,\r\n\t\t//默认缩放，需要和自己的新牌保持一致\r\n\t\tinitScale: 1.25,\r\n\t\t//手里牌列表\r\n\t\t//shouliList: [],\r\n\t\trealMjWidth:0,\r\n\t\t\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n    \t//计算一下实际牌的宽度,单个麻将实际宽度\r\n    \tthis.realMjWidth=(this.majiangWidth-this.majiangJianxi)*this.initScale;\r\n     \tthis.realMjHeight=(this.majiangHeight-this.majiangJianxi)*this.initScale;\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n    //初始化手里牌列表,mjs=[{xx:xx}]\r\n    initAllCurrentMj:function(mjs){\r\n    \tlet width=this.node.width;\r\n    \tlet aLength=mjs.length-1;\r\n    \t//最右边一颗\r\n    \tlet fixedPosition=this.getFixedPosition();\r\n    \t//console.log(fixedPosition) \r\n    \tmjs.forEach(function(value,index){\r\n    \t\tlet majiang = this.spawnNewMj(value,false);\r\n    \t\t//从左往右排列\r\n    \t\tlet pos=fixedPosition.sub(cc.v2((aLength-index)*this.realMjWidth,0));\r\n    \t\t//console.log(pos)\r\n    \t\tmajiang.setPosition(pos);\r\n    \t\tthis.node.addChild(majiang);\r\n    \t}.bind(this));\r\n    \t//盖牌\r\n    \t//1秒后排序\r\n    \tthis.scheduleUpdate();\r\n    },\r\n    scheduleUpdate:function(){\r\n    \tthis.scheduleOnce(function() {\r\n    \t\tconsole.log(\"更新顺序\");\r\n\t\t     this.updateSort();\r\n\t\t }, 0.5);\r\n    },\r\n\tgetOne:function(mjzz){\r\n\t\tconsole.log(\"获取新牌\")\r\n\t\tthis.game.hasNewMajiang=true; \r\n\t\tlet majiang = this.spawnNewMj(mjzz,true);\r\n\t\tthis.node.addChild(majiang);\r\n\t\t\r\n\t\tconsole.log(\"新\",this.game.hasNewMajiang);\r\n\t\tconsole.log(this.CurrentMj)\r\n\t},\r\n\t//生成麻将对象\r\n\tspawnNewMj: function(mjzz,isNewOne) {\r\n\t\tconsole.log(\"创建麻将：\", mjzz.huase, mjzz.number)\r\n\t\tvar mj = cc.instantiate(this.MjSprite);\r\n\t\tvar config = mj.getComponent('MajiangEntity');\r\n\t\tconfig.game = this.game;\r\n\t\tconfig.majiang=this;\r\n\t\tconfig.mjzz=mjzz;\r\n\t\tconfig.huase = mjzz.huase;\r\n\t\tconfig.number = mjzz.number;\r\n\t\tconfig.index = mjzz.index;\r\n\t\tconfig.isNewOne=isNewOne;\r\n\t\tmj.setScale(this.initScale);\r\n\t\t//把所有牌放入手头牌列表，即使是新牌，也算是自己的\r\n\t\tthis.game.shouliList.push(config);\r\n\t\treturn mj;\r\n\t},\r\n\tspawnNewOutMj: function(mjzz) {\r\n\t\tconsole.log(\"创建丢弃麻将：\", mjzz.huase, mjzz.number)\r\n\t\tvar mj = cc.instantiate(this.outPrefab);\r\n\t\tvar config = mj.getComponent('OutMj');\r\n\t\tconfig.game = this.game;\r\n\t\tconfig.dage = this.dustbin;\r\n\t\tconfig.huase = mjzz.huase;\r\n\t\tconfig.number = mjzz.number;\r\n\t\tconfig.index = mjzz.index;\r\n\t\tthis.dustbin.addNewMj(config);\r\n\t\t//config.setScale(this.dustbin.initScale);\r\n\t\t//把所有牌放入手头牌列表，即使是新牌，也算是自己的\r\n\t\treturn mj;\r\n\t},\r\n\t//循环调用其他牌的unselecte\r\n\tunSelectOthers:function(ent){\r\n\t\tthis.game.shouliList.forEach(function(value, index) {\r\n\t\t\tif(value.index!=ent.index && value.isSelected){\r\n\t\t\t\tvalue.unSelect();\r\n\t\t\t}\r\n\t\t}.bind(this));\r\n\t},\r\n\t//排序手里牌\r\n\tupdateSort:function(){\r\n\t\tlet newList = [];\r\n\t\t//计算可操作牌的起点位置\r\n\t\t//let aw = this.getAW();\r\n\t\tlet aLength=this.game.shouliList.length-1;\r\n\t\tlet fixedPosition=this.getFixedPosition();\r\n\t\t//新摸的牌已经放到最后一张，所以需要重新排序\r\n\t\tthis.game.shouliList.sort(function(a, b) {\r\n\t\t\treturn a.index - b.index;\r\n\t\t});\r\n\t\tlet newNode;\r\n\t\tlet newPos;\r\n\t\tlet isLast=false;\r\n\t\tlet rightLength;\r\n\t\t//循环设置新坐标\r\n\t\tthis.game.shouliList.forEach(function(value, index) {\r\n\t\t\t//从左往右排列\r\n    \t\tlet pos=fixedPosition.sub(cc.v2((aLength-index)*this.realMjWidth,0));\r\n    \t\tif(value.isNewOne){\r\n\t\t\t\tnewNode= value;  \r\n\t\t\t\tnewPos=pos;\r\n\t\t\t\t//是否最后一张牌，用不同的特效\r\n\t\t\t\tisLast=aLength==index;\r\n\t\t\t\t//右边有多少颗麻将\r\n\t\t\t\trightLength=aLength-index+1;\r\n    \t\t}else{\r\n    \t\t\tvalue.node.setPosition(pos);\r\n    \t\t}\r\n\t\t}.bind(this));\r\n\t\tif(newNode){\r\n\t\t\tlet parentNode=this.node;\r\n\t\t\t//移动节点，再设置坐标\r\n\t\t\tthis.scheduleOnce(function() {\r\n\t\t\t\tnewNode.node.parent= parentNode;\r\n\t\t\t\tnewNode.isNewOne=false;\r\n\t\t\t\tlet beginPos=fixedPosition.add(cc.v2(this.realMjWidth+28.5,0));\r\n\t\t\t\tnewNode.node.setPosition(beginPos);\r\n\t\t\t\t//初始设置类似新牌位置\r\n\t\t\t\t//newNode.node.setPosition(newPosFirst);\r\n\t\t\t\tif(isLast){\r\n\t\t\t\t\t//直接靠到最右边\r\n\t\t\t\t\tvar action = cc.moveTo(0.2, newPos);\r\n\t\t\t\t\taction.easing(cc.easeIn(3.0));\r\n\t\t\t\t\tnewNode.node.runAction(action);\r\n\t\t\t\t}else{\r\n\t\t\t\t\t//往上移动\r\n\t\t\t\t\tlet newPosFirst=beginPos.add(cc.v2(0,this.realMjHeight));\r\n\t\t\t\t\t//移动到指定位置的头上\r\n\t\t\t\t\tlet pos2 = newPos.add(cc.v2(0,this.realMjHeight));\r\n\t\t\t\t\t//起飞-->中间飞行(飞行时间=右边棋子个数*0.05秒)-->降落\r\n\t\t\t\t\tlet moveTime=0.15;\r\n\t\t\t\t\tlet flyAction = cc.moveTo(moveTime*rightLength, pos2);\r\n\t\t\t\t\tflyAction=flyAction.easing(cc.easeInOut(3.0));\r\n\t\t\t\t\tlet flyRota = cc.rotateTo(moveTime*rightLength, 0);\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet moveAction = cc.sequence(\r\n\t\t\t\t\t    cc.spawn(\r\n\t\t\t\t\t        cc.scaleTo(0.1, 0.8, 0.8),\r\n\t\t\t\t\t        cc.rotateTo(0.1, 61.0),\r\n\t\t\t\t\t        cc.moveTo(0.1, newPosFirst)\r\n\t\t\t\t\t    ),\r\n\t\t\t\t\t    cc.spawn(\r\n\t\t\t\t\t        cc.scaleTo(0.2, 1, 1),\r\n\t\t\t\t\t        flyRota,\r\n\t\t\t\t\t        flyAction\r\n\t\t\t\t\t    ),\r\n\t\t\t\t\t    cc.delayTime(0.1),\r\n\t\t\t\t\t    cc.spawn(\r\n\t\t\t\t\t        cc.scaleTo(0.1, this.initScale),\r\n\t\t\t\t\t        cc.moveTo(0.1, newPos)\r\n\t\t\t\t\t    )\r\n\t\t\t\t\t// 以1/2的速度慢放动画，并重复5次\r\n\t\t\t\t\t).speed(2);\r\n\t\t\t\t\tnewNode.node.runAction(moveAction);\r\n\t\t\t\t}\r\n\t\t\t\t//newNode.node.setPosition(newPos);\r\n\t\t\t\t//这一步很关键，如果不设置，他下次打出去的时候，就调用另外一个父类去排序\r\n\t\t\t\tnewNode.majiang=this;\r\n\t\t\t\tconsole.log(this.game.shouliList);\r\n\t\t\t\tconsole.log(newNode,newPos);\r\n\t\t \t}, 1);\r\n\t\t}\r\n\t},\r\n\t//从数组中，把数据先移除\r\n\tremoveFromList:function(ent){\r\n\t\tlet newList=[];\r\n\t\tthis.game.shouliList.forEach(function(value,index){\r\n\t\t\tif(value.index != ent.index){\r\n\t\t\t\tnewList.push(value);\r\n\t\t\t}\r\n\t\t}.bind(this));\r\n\t\tthis.game.shouliList=newList;\r\n\t\tconsole.log(\"移除之后\",this.game.shouliList);\r\n\t\tent.node.destroy();\r\n\t},\r\n\t//打出去一张手里牌，需要把新牌加进来，再排序\r\n\ttakeOut:function(ent){\r\n\t\tconsole.log(\"手里牌打出去\");\r\n\t\tlet posX=ent.node.x;\r\n\t\tlet outMj = this.spawnNewOutMj(ent.mjzz);\r\n\t\tconsole.log(outMj)\r\n\t\t//打出去牌默认位置\r\n\t\toutMj.setPosition(cc.v2(posX,0));\r\n\t\t//把自己从数组中移除\r\n\t\tthis.removeFromList(ent);\r\n\t\tthis.node.addChild(outMj);\r\n\t\t//生成一张丢棋牌,然后飞出去takeOut\r\n\t\tthis.scheduleOnce(function() {\r\n\t\t\t//如果直接转移到垃圾桶\r\n\t\t\toutMj.parent =this.dustbin.node;\r\n\t\t\toutMj.setPosition(cc.v2(0,0));\r\n\t\t\tconsole.log(\"转移父类\");\r\n\t\t }, 0.05);\r\n\t\t//this.dustbin.takeOut(ent.mjzz,pos1,cc.v2(0,0));\r\n\t},\r\n\t//从新牌那边移动过来\r\n\tmoveMjFromNew:function(){\r\n\t\t\r\n\t},\r\n\tunHighlightMj:function(mjzz){\r\n\t\tthis.dustbin.unHighlightMj(mjzz)\r\n\t},\r\n\thighlightMj:function(mjzz){\r\n\t\tthis.dustbin.highlightMj(mjzz)\r\n\t},\r\n\t//获取固定牌的定位\r\n\tgetFixedPosition:function(){\r\n    \t//手里牌宽度，固定后，不会随牌的数量增减而变化\r\n    \tlet width=this.node.width;\r\n    \t//console.log(this.node)\r\n    \t//最右边一颗\r\n    \tlet fixedPosition=cc.v2(width/2-this.realMjWidth/2);\r\n    \treturn fixedPosition;\r\n   }\r\n    // update (dt) {},\r\n});\r\n"]}